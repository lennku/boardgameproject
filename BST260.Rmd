----
title: "260Project_Chen"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(dslabs)
library(tidyverse)
library(dplyr)
ds_theme_set()

game <- read.csv(file = file.choose()) #4999   20
names(game)
summary(game)
```

1.	Model via stepwise elimination the best predictors of a good board game (based on game rating)
2.	Compare if model differs for avg rating vs geek rating
3.	
4.	Explore any interesting correlation between the covariates
5.	Test if we can accurately predict the rating of board games based on our model (https://boardgamegeek.com/browse/boardgame)
6.	Play the best/worst game ourselves to see if we agree :P (maybe)
7.	Design our own game based on findings (maybe)


### EDA
#1 ) missting value?
```{r}
missing(game)
```
 
#2) Relationship between geek_rating and avg_rating?
```{r}
game %>% ggplot(aes(geek_rating, avg_rating)) +
  geom_point(alpha = 0.8) +
   geom_smooth()
```

Seems that the ave_rating is higher than geek_rating in general (geeks seem more critical)

#3) Explore the distribution of our covariates in this dataset
```{r}
game %>% ggplot(aes(avg_time))+
  geom_histogram(bins = 100) 
```


```{r}
game %>% ggplot(aes(avg_time))+
  geom_histogram()+
  scale_x_continuous(trans = "log2") 
```

# Check the category
```{r}
library(purrr)
#data$cat <-as.character(data$category)
#data$cat <- str_split(cat, ',')
#cateogry <- do.call(rbind,catsplit)

split_into_multiple <- function(column, pattern = ", ", into_prefix){
  cols <- str_split_fixed(column, pattern, n = Inf)
  # Sub out the ""'s returned by filling the matrix to the right, with NAs which are useful
  cols[which(cols == "")] <- NA
  cols <- as.tibble(cols)
  # name the 'cols' tibble as 'into_prefix_1', 'into_prefix_2', ..., 'into_prefix_m' 
  # where m = # columns of 'cols'
  m <- dim(cols)[2]

  names(cols) <- paste(into_prefix, 1:m, sep = "_")
  return(cols)
}

d <- game %>% 
  select(rank, category, avg_rating) %>%
  bind_cols(split_into_multiple(data$category,',','category'))

d1 <- d %>% 
  select(-category, -rank) %>%
  gather(key, val, -avg_rating, na.rm = T)

d2 <- d1 %>% group_by(val) %>% summarise(average_rating = mean (avg_rating)) 

d2 %>% ggplot(aes(val, y = average_rating))+
  geom_point(size=0.1)+
  theme(text = element_text(size=5),
        axis.text.x = element_text(angle = 90, hjust =0))
 
```

